# 🔧 管理后台使用说明

## 📋 功能概览

专业的数据库管理界面，为 jerry 管理员提供全面的数据查看和管理能力。

---

## 🚀 访问方式

### 本地开发
```
http://localhost:3000/admin/database
```

### 生产环境（Railway）
```
https://ai-news-chat-production.up.railway.app/admin/database
```

### 登录凭证
- **用户名：** jerry
- **密码：** 123123

---

## ✨ 核心功能

### 1. 统计概览卡片

顶部显示关键统计数据：
- 👥 **总用户数** - 所有注册用户
- 🏠 **总房间数** - 创建的所有房间
- 💬 **总消息数** - 发送的所有消息
- 📷 **朋友圈数** - 发布的所有朋友圈

---

### 2. 标签页数据展示

#### 👤 用户（Users）
显示所有注册用户信息：
- ID、用户名、昵称
- 头像
- 注册时间
- 加入的房间数
- 发送的消息数
- 操作按钮（查看详情）

**搜索字段：** 用户名、昵称

#### 💬 房间（Rooms）
显示所有创建的房间：
- 房间ID、名称、描述
- 群主信息
- 成员数、NPC数
- 消息总数
- 创建时间
- 操作按钮（查看详情、进入房间）

**搜索字段：** 房间ID、名称、描述

**特殊操作：**
- 点击"进入"直接跳转到房间页面

#### 🤖 NPC
显示所有 NPC 角色：
- ID、名称、头像
- 所属房间（ID和名称）
- 人设简介
- 创建时间
- 操作按钮（查看详情）

**搜索字段：** 名称、人设、房间ID

#### 💭 消息（Messages）
显示最近1000条消息：
- 消息ID
- 所属房间
- 发送者名称
- 类型标签（👤玩家 / 🤖NPC）
- 消息内容（最多50字符）
- 发送时间

**搜索字段：** 发送者名称、内容、房间ID

#### 📸 朋友圈（Moments）
显示所有朋友圈动态：
- 朋友圈ID
- 发布者名称
- 类型（👤玩家 / 🤖NPC）
- 所属房间（全局或房间ID）
- 内容（最多60字符）
- 点赞数、评论数
- 发布时间

**搜索字段：** 内容

---

### 3. 搜索和过滤

#### 搜索功能
- 实时搜索，无需按回车
- 根据当前标签页的内容进行搜索
- 支持模糊匹配

#### 排序功能
- 最新创建（默认）
- 最早创建
- ID降序
- ID升序

#### 清除筛选
点击"清除筛选"按钮可重置所有过滤条件

---

### 4. 数据导出

#### 导出功能
点击顶部"📥 导出数据"按钮：
- 导出完整数据库数据
- JSON 格式
- 包含所有表的数据
- 文件名：`database-export-{时间戳}.json`

#### 导出内容
```json
{
  "stats": { /* 统计数据 */ },
  "users": [ /* 用户列表 */ ],
  "rooms": [ /* 房间列表 */ ],
  "npcs": [ /* NPC列表 */ ],
  "messages": [ /* 消息列表 */ ],
  "moments": [ /* 朋友圈列表 */ ]
}
```

---

### 5. 详情查看

#### 查看详情
点击任意数据行的"查看"按钮：
- 弹出详情窗口
- 显示完整的 JSON 数据
- 方便查看和调试
- 点击蒙层或关闭按钮关闭

---

## 🎨 界面特点

### 现代化设计
- 渐变紫色背景
- 白色卡片设计
- 圆角和阴影效果
- 平滑动画过渡

### 数据可视化
- 彩色图标
- 类型标签（玩家/NPC）
- 头像预览
- 数据统计卡片

### 响应式布局
- 适配桌面端
- 支持平板
- 兼容手机端

### 用户体验
- 加载动画
- 错误提示
- 空状态提示
- Hover 效果

---

## 🔐 权限管理

### 管理员验证
只有以下用户可以访问：
- `jerry`
- `admin`

### 访问限制
非管理员用户访问时：
- 自动跳转到登录页
- 显示"权限不足"提示

---

## 📊 性能优化

### 数据加载
- 消息限制最近1000条
- 朋友圈限制最近500条
- 使用索引优化查询

### 前端优化
- 使用 `computed` 计算属性
- 避免重复渲染
- 按需加载标签页内容

---

## 🛠️ 技术栈

### 前端
- **Vue 3** - 组合式 API
- **原生 CSS** - 无第三方UI库
- **响应式设计** - 适配各种设备

### 后端
- **Nuxt Server API** - 服务端接口
- **Better-sqlite3** - SQLite 数据库
- **权限验证** - getCurrentUser

---

## 📱 使用场景

### 1. 用户管理
- 查看所有注册用户
- 了解用户活跃度
- 追踪用户行为

### 2. 内容审核
- 查看所有消息内容
- 检查朋友圈动态
- 监控不当内容

### 3. 数据分析
- 统计房间活跃度
- 分析NPC表现
- 追踪系统使用情况

### 4. 问题排查
- 快速定位问题数据
- 查看完整数据结构
- 调试系统行为

### 5. 数据备份
- 定期导出数据
- 保存重要记录
- 恢复数据参考

---

## 🎯 快速操作

### 查看特定房间的所有消息
1. 切换到"消息"标签页
2. 在搜索框输入房间ID
3. 查看该房间的所有消息

### 查看特定用户的活跃度
1. 切换到"用户"标签页
2. 搜索用户名或昵称
3. 查看房间数和消息数

### 查看最近的朋友圈动态
1. 切换到"朋友圈"标签页
2. 默认显示最新动态
3. 查看点赞和评论数

### 导出完整数据库
1. 点击右上角"导出数据"
2. 自动下载 JSON 文件
3. 使用编辑器查看或分析

---

## ⚠️ 注意事项

### 数据安全
- 仅管理员可访问
- 不要泄露导出的数据
- 定期检查权限设置

### 性能考虑
- 大量数据可能加载较慢
- 搜索会实时过滤数据
- 导出大文件需要时间

### 数据一致性
- 刷新按钮重新加载数据
- 数据为实时快照
- 修改需要重新加载

---

## 🔄 更新日志

### v2.0.0 (2025-11-06)
- ✅ 全新的专业UI设计
- ✅ 标签页展示所有数据
- ✅ 实时搜索和排序
- ✅ 统计数据可视化
- ✅ 数据导出功能
- ✅ 详情查看弹窗
- ✅ 响应式设计
- ✅ 朋友圈数据展示

### v1.0.0 (初始版本)
- 基础数据展示
- 简单的表格视图

---

## 🚀 后续计划

### 计划功能
- [ ] 数据编辑功能
- [ ] 批量操作
- [ ] 数据图表可视化
- [ ] 更多过滤条件
- [ ] 数据导入功能
- [ ] 实时数据刷新
- [ ] 操作日志记录

---

## 📞 技术支持

如有问题，请联系系统管理员 jerry。

---

**最后更新：** 2025-11-06  
**版本：** v2.0.0  
**状态：** ✅ 已部署到 Railway

