# 🧪 部署后测试清单

## ⏰ 预计部署时间：5-10分钟

## 📋 测试步骤

### 第一步：确认部署成功

访问主页：https://ai-news-chat-production.up.railway.app

- [ ] 页面正常加载
- [ ] 没有白屏或错误
- [ ] 可以看到登录/注册界面

---

### 第二步：测试基础功能

1. **登录测试**
   ```
   用户名: jerry
   密码: 123123
   ```
   - [ ] 登录成功
   - [ ] 可以看到群聊列表

2. **群聊功能测试**
   - [ ] 点击任一群聊
   - [ ] 可以看到历史消息
   - [ ] AI角色正常回复
   - [ ] 可以发送消息

---

### 第三步：测试Creator新功能

访问：https://ai-news-chat-production.up.railway.app/creator

#### 3.1 预设剧情测试
- [ ] 页面加载成功
- [ ] 显示11个预设剧情：
  - [ ] 办公室风云
  - [ ] 绝命毒师
  - [ ] 甄嬛传
  - [ ] NBA赛季
  - [ ] 加密货币
  - [ ] 特朗普vs拜登
  - [ ] 特朗普vs马斯克
  - [ ] 王宝强事件
  - [ ] 明星八卦
  - [ ] 科技创业
  - [ ] 家庭伦理
- [ ] 每个剧情有5个NPC
- [ ] 总计显示"55个角色"

#### 3.2 AI智能解析测试
1. **点击「➕ 新建剧情」**
   - [ ] 模态框正常打开
   - [ ] 可以看到「🤖 AI智能解析」区域

2. **测试AI解析**
   
   **测试文本（复制粘贴）：**
   ```
   王宝强和马蓉在2009年结婚，婚后育有一儿一女。2016年8月，王宝强发现妻子马蓉与其经纪人宋喆存在不正当关系，且在婚内出轨并转移、隐匿夫妻共同财产。王宝强随即发布离婚声明，并向法院起诉离婚，同时解除与宋喆的经纪合约。这一事件在社交媒体引起轩然大波，成为2016年最热门的娱乐新闻之一。
   ```
   
   - [ ] 粘贴文本到输入框
   - [ ] 点击「✨ AI智能解析」
   - [ ] 等待3-10秒
   - [ ] 显示解析结果：
     - [ ] 剧情名称自动填充
     - [ ] 事件背景自动填充
     - [ ] 显示识别到的角色（王宝强、马蓉、宋喆）
     - [ ] 显示解析说明
   
3. **创建剧情**
   - [ ] 点击「创建」按钮
   - [ ] 剧情创建成功
   - [ ] 自动跳转到剧情详情页
   - [ ] 可以看到3个自动创建的NPC
   - [ ] 每个NPC都有完整的10项属性：
     - 性格、习惯、技能
     - 喜好、厌恶、年龄、职业
     - 背景故事、目标、恐惧

#### 3.3 导出功能测试
- [ ] 点击任一剧情
- [ ] 点击「📤 导出」按钮
- [ ] JSON文件正常下载
- [ ] 文件包含所有剧情和NPC数据

---

### 第四步：测试Map Creator功能

访问：https://ai-news-chat-production.up.railway.app/map-creator

#### 4.1 基础功能
- [ ] 页面加载成功
- [ ] 可以看到画布
- [ ] 可以调整地图尺寸
- [ ] 可以绘制地图

#### 4.2 AI地图生成
1. **测试生成**
   - [ ] 点击「🎨 AI生成地图模板」
   - [ ] 输入描述："生成一个16x16的村庄，有房子、道路、河流和花园"
   - [ ] 点击生成
   - [ ] 等待5-15秒
   - [ ] 地图生成成功
   - [ ] 可以看到不同颜色的区块
   - [ ] 地图自动保存

2. **查看生成效果**
   - [ ] 地图有合理的布局
   - [ ] 颜色搭配协调
   - [ ] 有明显的变体（如花1、花2、花3）

#### 4.3 地图保存和加载
- [ ] 点击「📂 加载已保存的地图」
- [ ] 可以看到刚才生成的地图
- [ ] 显示地图信息（尺寸、类型数、时间）
- [ ] 点击加载
- [ ] 地图正确加载到画布

#### 4.4 AI自动分层
1. **准备**
   - [ ] 确保已有地图（可使用上面生成的）
   - [ ] 填写世界描述："这是一个宁静的村庄"

2. **执行分层**
   - [ ] 点击「AI自动分层」
   - [ ] **不需要定义区域**（新功能！）
   - [ ] 确认对话框显示"对整个地图进行分层"
   - [ ] 点击确定
   - [ ] 等待5-15秒
   - [ ] 分层完成
   - [ ] 右侧显示生成的图层
   - [ ] 可以下载各个图层

#### 4.5 Tile Set功能
- [ ] 可以上传Tile Set图片
- [ ] 自动切割功能正常
- [ ] 可以手动调整切割参数
- [ ] 颜色-Tile映射正常

---

## ⚠️ 常见问题排查

### 问题1：AI功能不工作（解析/生成失败）
**原因：** DEEPSEEK_API_KEY未设置或错误

**排查：**
1. 访问Railway Dashboard
2. 进入项目 → Variables标签
3. 检查`DEEPSEEK_API_KEY`是否存在
4. 如果不存在或错误，添加/更新后重新部署

### 问题2：预设剧情显示0个
**原因：** 数据库未初始化

**解决：**
1. 访问：`/creator`
2. 点击「📦 加载预设剧情」按钮
3. 等待加载完成
4. 刷新页面

### 问题3：页面白屏或404
**原因：** 静态资源未正确部署

**解决：**
1. 检查Railway构建日志
2. 确认`public/`目录是否包含在部署中
3. 重新部署

### 问题4：数据库连接错误
**原因：** PostgreSQL插件未正常运行

**解决：**
1. 检查Railway项目的PostgreSQL插件
2. 确认`DATABASE_URL`环境变量已自动设置
3. 重启PostgreSQL服务

---

## 📊 测试结果记录

测试时间：__________

| 功能模块 | 状态 | 备注 |
|---------|------|------|
| 主应用登录 | ⬜ | |
| 群聊功能 | ⬜ | |
| Creator预设剧情 | ⬜ | |
| AI智能解析 | ⬜ | |
| NPC自动创建 | ⬜ | |
| Map Creator基础 | ⬜ | |
| AI地图生成 | ⬜ | |
| 地图保存加载 | ⬜ | |
| AI自动分层 | ⬜ | |
| Tile Set管理 | ⬜ | |

**总体评分：** ___ / 10

**发现的问题：**
1. 
2. 
3. 

---

## ✅ 测试完成后

1. **性能监控**
   - 在Railway Dashboard查看资源使用
   - CPU和内存是否正常
   - 响应时间是否可接受

2. **日志检查**
   - 查看是否有错误日志
   - 检查AI API调用是否成功

3. **用户通知**
   - 新功能已上线
   - 提供使用指南

---

**测试员：** __________
**日期：** __________
**部署版本：** 2.0 (commit: 1a6247a)

🎉 测试愉快！

