# Map Creator - 智能地图编辑器

## 产品概述

Map Creator 是一款专为游戏开发、剧情设计和世界构建打造的可视化地图编辑工具。它结合了传统瓦片地图编辑器的灵活性与AI智能分层技术，让创作者能够快速构建2D游戏世界，并自动生成符合Tiled标准的TMJ格式地图文件。

## 核心功能

### 1. 多样化绘制工具
- **画笔工具**：支持1-10格可调节笔刷，流畅绘制大面积地形
- **橡皮擦**：快速清除或修改已绘制区域
- **单格精绘**：逐格精确编辑，适合细节雕琢
- **矩形填充**：快速创建规则建筑、房间等结构
- **智能填充**：一键填充相邻同类型区域，提升效率10倍
- **区域勾选**：框选任意区域定义为语义化空间（如"客厅"、"花园"）

### 2. 智能历史管理
- **无限撤销/重做**（最多50步）：支持 Ctrl+Z / Ctrl+Y 快捷键
- **实时状态保存**：每次操作自动记录，防止误操作
- **快速回溯**：随时返回任意历史状态

### 3. 可视化区域管理
- **半透明覆盖层**：所有定义区域自动添加彩色标识
- **悬停高亮**：鼠标经过时区域自动高亮，边框加粗
- **智能标签**：实时显示区域名称、坐标范围和尺寸
- **详细提示框**：悬停显示区域的完整属性信息
- **自定义属性**：为每个区域添加游戏逻辑属性（如"可进入"、"触发事件"等）

### 4. 丰富的瓦片类型
内置6种基础地形：
- 草地（ground）
- 围墙（building）
- 建筑（building）
- 河流（water）
- 房屋内部（indoor）
- 道路（road）

支持自定义扩展更多瓦片类型。

### 5. TMJ标准导出
- 完全兼容 Tiled Map Editor 格式
- 一键导出为 `.tmj` JSON文件
- 包含完整的瓦片数据、区域定义和自定义属性
- 可直接导入主流游戏引擎（Unity、Godot、Phaser等）

### 6. AI自动分层（规划中）
- 输入世界描述文本
- AI自动识别地形类型
- 智能生成多图层结构（地面层、建筑层、装饰层、碰撞层）
- 优化游戏引擎渲染性能

## 应用场景

### 游戏开发
- **独立游戏制作**：快速构建2D RPG、像素冒险、塔防等游戏的关卡地图
- **原型设计**：在开发早期快速验证关卡布局和玩法
- **关卡编辑器**：为游戏内置关卡编辑功能提供参考实现

### 剧情设计
- **空间规划**：为Story Creator中的剧情设计物理空间背景
- **场景可视化**：将文字剧情转化为可视化地图，增强沉浸感
- **事件触发区域**：定义角色互动的空间边界和触发点

### 教育培训
- **游戏设计教学**：帮助学生理解瓦片地图原理和游戏关卡设计
- **可视化编程**：结合地图属性进行游戏逻辑编程教学
- **创意启发**：激发创意思维，培养空间布局能力

### 世界构建
- **桌游地图**：为TRPG、桌面游戏设计战斗地图
- **小说配图**：为文学作品绘制场景平面图
- **虚拟空间**：构建元宇宙、虚拟社区的2D平面布局

## 操作体验

### 快捷键设计
- **数字键 1-6**：快速切换绘制模式
- **[ / ]**：调整画笔大小（+1 / -1）
- **Ctrl+Z / Ctrl+Y**：撤销/重做
- **鼠标拖拽**：流畅绘制，所见即所得

### 实时反馈
- 选择时显示尺寸和坐标信息
- 画笔/橡皮擦显示圆形预览光圈
- 区域悬停即时高亮
- 操作无延迟，支持64×64以上大型地图

## 技术特点

- **纯前端实现**：基于HTML5 Canvas，无需后端服务
- **高性能渲染**：优化的网格绘制算法，流畅支持大型地图
- **标准兼容**：完全遵循Tiled TMJ 1.8格式规范
- **轻量级**：零依赖，文件大小<50KB
- **响应式设计**：适配各种屏幕尺寸

## 数据格式

### 导出的TMJ文件包含
1. **地图元数据**：宽度、高度、瓦片尺寸、版本信息
2. **图层数据**：每个瓦片的类型ID数组
3. **瓦片集定义**：所有瓦片类型的属性（名称、颜色、类别）
4. **区域属性**：用户定义的语义区域及其自定义属性
5. **世界描述**：可选的全局描述文本

### 数据结构示例
```json
{
  "width": 64,
  "height": 64,
  "tilewidth": 16,
  "tileheight": 16,
  "version": "1.8",
  "type": "map",
  "orientation": "orthogonal",
  "layers": [...],
  "tilesets": [...],
  "properties": [
    {
      "name": "worldDescription",
      "type": "string",
      "value": "一个被魔法森林环绕的中世纪王国..."
    }
  ]
}
```

## 与Story Creator的集成

Map Creator 是 Story Creator 生态的重要组成部分：

1. **空间化剧情**：为AI剧情对话提供物理空间背景
2. **角色定位**：明确NPC和玩家角色的空间位置
3. **事件触发**：基于区域属性触发剧情分支
4. **沉浸式体验**：结合地图和对话，打造完整的互动叙事体验

## 未来规划

### 短期（1-2个月）
- ✅ 完善AI自动分层功能
- ✅ 添加图块复制/粘贴功能
- ✅ 支持多图层编辑
- ✅ 导入已有TMJ文件进行编辑

### 中期（3-6个月）
- 支持动画瓦片
- 添加碰撞层可视化编辑
- 集成在线瓦片素材库
- 多人协作编辑

### 长期（6-12个月）
- 3D地形预览
- 与Unity/Godot的直接集成插件
- 地图版本管理和协作分享
- 移动端编辑支持

## 使用流程

1. **创建地图**：设置地图尺寸（如64×64）
2. **选择瓦片**：从左侧面板选择地形类型
3. **开始绘制**：使用画笔、矩形等工具绘制地形
4. **定义区域**：使用勾选工具框选区域并添加语义信息
5. **添加属性**：为区域添加自定义属性（可访问性、能量恢复等）
6. **导出地图**：点击"导出Raw Map (TMJ)"保存为标准格式
7. **AI分层**（可选）：输入世界描述，让AI自动优化图层结构

## 总结

Map Creator 不仅是一款地图编辑工具，更是连接创意和实现的桥梁。无论你是独立游戏开发者、剧情设计师，还是游戏设计爱好者，它都能帮助你快速将脑海中的世界转化为可交互的数字地图。

**开始创作你的世界吧！**

🌐 访问地址：http://localhost:3001/map-creator
📚 返回Story Creator：http://localhost:3001/creator

