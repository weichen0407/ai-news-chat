# 🔧 重启服务教程

## 为什么需要重启？

当我修改了代码后，必须重启 `npm run dev` 服务，新代码才会生效。

你现在运行的还是**旧代码**（有bug的版本），所以NPC不会回复。

---

## 📝 重启步骤（3步搞定）

### 第1步：停止当前服务 ⏹️

**找到运行 `npm run dev` 的终端窗口**

然后按：
```
Mac用户：Control + C
Windows用户：Ctrl + C
```

**看到这个就说明停止成功：**
```
^C
Stopping dev server...
```

---

### 第2步：重新启动 ▶️

在同一个终端窗口输入：
```bash
npm run dev
```

按回车，等待5-10秒。

**看到这些就说明启动成功：**
```
✓ Vite server ready in XXXms
✓ Nitro server started
  Local: http://localhost:3001
  Network: http://192.168.110.247:3001
```

---

### 第3步：测试NPC回复 🧪

#### 3.1 刷新浏览器
- 按 F5 或点击刷新按钮
- 确保加载的是新代码

#### 3.2 进入朋友圈
- 点击底部「🎭 朋友圈」

#### 3.3 找到特朗普的朋友圈
- 找到这条：
  ```
  特朗普：假新闻媒体又在撒谎！拜登根本不知道自己在说什么...
  ```
- 这是朋友圈 ID: 89

#### 3.4 再评论一次
- 点击「💬」评论
- 输入：`测试自动回复`
- 发送

#### 3.5 立即查看终端
**重点！评论后马上看终端窗口！**

应该**立即**看到这些日志：
```
🔔 触发NPC自动回复，评论ID: 21
📋 评论信息 - user_id: 1 moment_id: 89
🤖 开始NPC自动回复流程，评论ID: 21
🏠 朋友圈作者是NPC，房间ID: PRESET_TRUMP
🤖 需要回复的NPC数量: 1
🤖 拜登 正在生成回复...
```

如果**看到这些日志**，说明成功了！

#### 3.6 等待AI生成
- 等待15-20秒
- 让AI生成回复

#### 3.7 刷新查看结果
- 刷新页面（F5）
- 进入朋友圈
- 找到你刚才评论的那条
- ✅ **应该能看到拜登的回复了！**

---

## ❓ 如果还是不行

### 情况1：Ctrl+C 不管用

**方法1：多按几次**
```
按 3-5 次 Ctrl+C
```

**方法2：强制关闭**
```
Mac: Command + Q 关闭终端，然后重新打开
Windows: 直接关闭命令提示符窗口
```

然后：
```bash
cd /Users/QRF/Desktop/AI-news
npm run dev
```

---

### 情况2：重启后还是没有日志

如果重启后评论，终端**还是没有**显示：
```
🔔 触发NPC自动回复
```

那说明有其他问题，告诉我：
1. 终端有显示任何错误吗？
2. 浏览器控制台（F12）有错误吗？
3. 截图给我看

---

### 情况3：有日志但没有回复

如果终端显示了：
```
🔔 触发NPC自动回复
🤖 开始NPC自动回复流程
```

但最后没有回复，可能是：
1. ❌ DeepSeek API调用失败（网络问题）
2. ❌ API密钥过期
3. ❌ 数据库插入失败

告诉我终端显示的**完整日志**，特别是有没有：
```
❌ 的错误信息
```

---

## 📸 需要帮助？

如果按照上面步骤还是不行，拍照/截图给我：

1. **终端的日志**
   - 从你评论开始的那部分
   - 包括所有 🔔 🤖 ✅ ❌ 的日志

2. **浏览器的样子**
   - 你评论的那条朋友圈
   - 刷新后的样子

3. **浏览器控制台**
   - 按 F12
   - 切换到 Console 标签
   - 看看有没有红色错误

---

## ✅ 预期的成功流程

```
你评论 → 终端立即显示 🔔
       ↓
等待3-5秒 → 终端显示 🤖 拜登 正在生成回复...
       ↓
等待10-15秒 → 终端显示 ✅ 拜登 生成的回复: "..."
       ↓
刷新页面 → 看到拜登的回复在评论下方
       ↓
🎉 成功！
```

---

## 🎯 关键点总结

1. ✅ **重启后代码才生效**
2. ✅ **评论后立即看终端**
3. ✅ **有 🔔 就说明触发了**
4. ✅ **等待15秒后刷新**
5. ✅ **评论NPC的朋友圈，不是自己的**

现在去重启服务吧！

